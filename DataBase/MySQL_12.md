# 视图（view）

emp表的列信息很多，有些信息是个人重要信息（比如sal，comm，mgr，hiredate），如果我们希望某个用户只能查询emp表的(empno，ename，job和deptno）信息，有什么办法？

1：视图是根据基表创建的虚拟表，内容由查询定义。同真实的表一样，视图包含列，其数据来自对应的真实表（基表）

2.视图，就是将单表或多表的查询的数据，数据封装到视图中。视图和基表数据的修改互相影响，就像Java的引用类型，改变引用类型的变量也会导致原来的数据发生变化（映射）



视图的基本使用

```mysql
create view 视图名 as select 列 from 基表
alter view 视图名 as select 列 from 基表
SHOW CREATE VIEW 视图名
drop view 视图名1, 视图名2
```

使用细节：

- 创建视图后，到数据库去看，对应视图只有一个视图结构文件（形式：视图名.frm）
- 视图的数据变化会影响到基表，基表的数据变化也会影响到视图[insert/update/delete]
- 视图中可以再创建视图，数据仍然来自基表





视图最佳实践
1. 安全。一些数据表有看重要的信息。有些学段是保密的，不能让用户直接看到。这时就可以创建一个视图，在这张视图中只保留一部分学字段。这样，用户就可以查询自己需要的字段，不能查看保密的字段。
2. 性能。关系数据库的数据常常会分表存储， 使用外键建立这些表的之间关系。 这时数据库查询通常会用到连接（JOIN）。这样做不但麻烦，效率相对也比较低。如果建立一个视图，将相关的表和字段组合在一起，就可以避免使用JOIN查询数据。
3. 灵活。如果系统中有一张旧的表，这张表由于设计的问题，即将被废弃奔。然而，很多应用都是基于这张表，不易修改。这时就可以建立一张视图，视图中的数据直接映射到新建的表。这样，就可以少做很多改动，也达到了升级数据表的目的。



案例：针对emp, dept 和salgrade 三张表，创建一个视图emp_view 显示雇员编号、雇员名、雇员部门名称和薪水级别

解析：使用三表联合查询，构建一个视图

```mysql
CREATE VIEW emp_view AS
	SELECT empno, ename, dname, grade
	FROM emp,dept, salgrade
	WHERE emp.deptno = dept.deptno AND
		sal BETWEEN losal AND hisal;
```

